
<ion-header>
  <ion-toolbar color="primary">
    <ion-title *ngIf="!searchbarVisible">Übersicht</ion-title>
    <ion-button *ngIf="!searchbarVisible" (click)="startSearch()" slot="end">
      <ion-icon slot="icon-only" name="search"></ion-icon>
    </ion-button>
    <ion-searchbar [(ngModel)]="search" *ngIf="searchbarVisible"
                   (ionChange)="doSearch()"
                   (ionCancel)="cancelSearch()"
                   (ionClear)="clearSearch()"
                   [showCancelButton]="true"
                   [showClearButton]="true"
                   placeholder="Suche">
    </ion-searchbar>
  </ion-toolbar>
  <ion-grid>
    <ion-row class="ion-justify-content-evenly">
      <ion-col class="ion-no-padding">
        <ion-button expand="full" (click)="buttonHandler(0); filterTransaction(this.search)">
          <ion-text></ion-text>
          <ion-text>{{outgoing}}€ Ausgaben</ion-text>
        </ion-button>
      </ion-col>
      <ion-col class="ion-no-padding">
        <ion-button expand="full" (click)="buttonHandler(1); filterTransaction(this.search)">{{incoming}}€ Einnahmen</ion-button>
      </ion-col>
      <ion-col class="ion-no-padding">
        <ion-button expand="full" (click)="buttonHandler(2); filterTransaction(this.search)">{{pending}} Ausstehend</ion-button>
      </ion-col>
      <ion-col class="ion-no-padding">
        <ion-button expand="full" (click)="buttonHandler(3); filterTransaction(this.search)">{{confirm}} Bestätigen</ion-button>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-header>

<ion-content>
  <ion-refresher id="refresher" slot="fixed" pullFactor="0.3" (ionRefresh)="refreshHandler($event)">
    <ion-refresher-content
      pullingText="Pull to refresh"
      pullingIcon="chevron-down-circle-outline"
      refreshingText="Refreshing...">
    </ion-refresher-content>
  </ion-refresher>
  <ion-list>
      <ion-item button *ngFor="let transaction of filteredTransactions" (click)="viewTransaction(transaction.id)" lines="full">
        <ion-grid style=" margin-bottom: 1%; margin-top: 1%; width: 100%; height: 100%;">
          <ion-row>
            <ion-col align="left"><ion-avatar><img src="{{transaction.otherUser.profilePic}}"></ion-avatar></ion-col>
          <ion-col>
            <div>{{transaction.purpose}}</div>
            <div style="font-size: small">{{transaction.groupName? transaction.groupName : "Gruppenname" }}, {{transaction.otherUser.displayName}}</div>
          </ion-col>
          <ion-col align="right" >{{transaction.amount}}€</ion-col>
            <ion-col *ngIf="confirmView"><ion-button (click)="confirmTransaction()">x</ion-button></ion-col>
          </ion-row>
        </ion-grid>
      </ion-item>
  </ion-list>

</ion-content>

<ion-footer>
  <ion-toolbar>
  <ion-tabs>
    <ion-tab-bar>
      <ion-tab-button>
        <ion-icon name="home-outline"></ion-icon>
        <ion-badge></ion-badge>
      </ion-tab-button>

      <ion-tab-button (click)="redirect('transaction')">
        <ion-icon name="cash-outline"></ion-icon>
      </ion-tab-button>

      <ion-tab-button (click)="redirect('group')">
        <ion-icon name="people-outline"></ion-icon>
      </ion-tab-button>

      <ion-tab-button (click)="redirect('profile')">
        <ion-icon name="person-outline"></ion-icon>
      </ion-tab-button>
    </ion-tab-bar>

  </ion-tabs>
  </ion-toolbar>
</ion-footer>
